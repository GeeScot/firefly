<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="styles.css" />
    <script type="text/javascript" src="functions.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" />
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <title>StreamLabs to Firebot</title>
  </head>

  <body>
    <h2>StreamLabs Chatbot XLSX -> Firebot NeDB</h2>
    <div class="container">
      <div class="how-to">
        <h4>How to migrate Quotes from StreamLabs</h4>
        <div>
          To export quotes from StreamLabs Chatbot (Desktop):
        </div>
        <div class="code">
          Connections (the person icon) > Cloud > Create/Export split excel
          files
        </div>
        <div>
          They will go to the local "cloud" folder
        </div>
        <div>
          Expected quote format:
        </div>
        <div class="code">
          Totally not out of context quote [Game] [dd/mm/yyyy]
        </div>
        <div>
          Supported date formats:
        </div>
        <div class="code">
          <div>[ddmmyyyy]</div>
          <div>[dd-mm-yyy]</div>
          <div>[dd/mm/yyyy]</div>
          <div>[dd.mm.yyyy]</div>
        </div>
        <div>
          Once you get the quotes.db file you can replace it in your main profile of Firebot and your quotes should be there when you reopen Firebot.
        </div>
        <div class="code">
          %appdata%\Firebot\v5\profiles\Main Profile\db
        </div>
        <div class="code">
          <img alt="json currency example" src="images/firebot_dbs.png" width="400" />
        </div>
      </div>

      <div class="migration-form">
        <h4>Quote Migration</h4>
        <div>
          <label>Your twitch username</label>
        </div>
        <div>
          <input
            type="text"
            id="streamer"
            name="streamer"
            placeholder="GeeScot"
            onblur="this.placeholder = 'GeeScot'"
            onfocus="this.placeholder = ''"
          />
        </div>
        <div>
          <label for="quotelist">Your quotes file (xlsx)</label>
        </div>
        <div class="file-upload">
          <input type="file" id="quotelist" name="quotelist" />
        </div>
        <input
          id="quotesbutton"
          type="button"
          value="Migrate Quotes"
          onclick="getQuotesNeDB(event)"
        />
      </div>
    </div>
    <div class="container">
      <div class="how-to">
        <h4>How to migrate Users from StreamLabs</h4>
        <div>
          If you want to migrate user points/hours that are in a points.xlsx file
          from the StreamLabs Chatbot backups (use the steps above for Quotes
          migration to get the users/points xlsx file).
        </div>
        <div>
          It has to be in the format Name, Rank, Points, Hours. The Rank will be
          ignored in the migration.
        </div>
        <div class="code">
          <img alt="xlsx users format" src="images/points_format.png" width="400" />
        </div>
        <div>
        You'll need to set up a currency first and then grab the currency id
        from the currency.json file in:
        </div>
        <div class="code">
          %appdata%\Firebot\v5\profiles\Main Profile\currency
        </div>
        <div class="code">
          <img alt="json currency example" src="images/currency_example.png" width="400" />
        </div>
      </div>

      <div class="migration-form">
        <h4>User Migration</h4>
        <div>
          <label for="currencyId">Your currency id</label>
        </div>
        <div>
          <input
            type="text"
            id="currencyId"
            name="currencyId"
            placeholder="00000000-0000-0000-0000-000000000000"
            onblur="this.placeholder = '00000000-0000-0000-0000-000000000000'"
            onfocus="this.placeholder = ''"
          />
        </div>
        <div>
          <label for="userlist">Your users/points file (xlsx)</label>
        </div>
        <div class="file-upload">
          <input type="file" id="userlist" name="userlist" />
        </div>
        <input
          id="usersbutton"
          type="button"
          value="Migrate Users"
          onclick="getUsersNeDB(event)"
        />
      </div>
    </div>
  </body>
</html>
